utility functions for version 5. With login functionality.